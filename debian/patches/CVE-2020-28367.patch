Index: golang-1.8-1.8.1/src/cmd/go/security.go
===================================================================
--- golang-1.8-1.8.1.orig/src/cmd/go/security.go	2020-11-19 22:55:01.037128808 +0100
+++ golang-1.8-1.8.1/src/cmd/go/security.go	2020-11-19 22:55:01.033128605 +0100
@@ -38,7 +38,7 @@
 var re = regexp.MustCompile
 
 var validCompilerFlags = []*regexp.Regexp{
-	re(`-D([A-Za-z_].*)`),
+        re(`-D([A-Za-z_][A-Za-z0-9_]*)(=[^@\-]*)?`),
 	re(`-I([^@\-].*)`),
 	re(`-O`),
 	re(`-O([^@\-].*)`),
Index: golang-1.8-1.8.1/src/cmd/go/security_test.go
===================================================================
--- golang-1.8-1.8.1.orig/src/cmd/go/security_test.go	2020-11-19 22:55:01.037128808 +0100
+++ golang-1.8-1.8.1/src/cmd/go/security_test.go	2020-11-19 23:01:06.087687054 +0100
@@ -67,6 +67,7 @@
 	{"-O@1"},
 	{"-Wa,-foo"},
 	{"-W@foo"},
+	{"-Wp,-DX,-D@X"},
 	{"-g@gdb"},
 	{"-g-gdb"},
 	{"-march=@dawn"},
